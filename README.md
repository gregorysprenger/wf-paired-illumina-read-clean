# Clean Paired Illumina Reads Workflow

## Steps in the workflow
1. Run [paired-illumina-read-clean](https://github.com/chrisgulvik/UnivaGridEngine_UGE_cluster_scripts/blob/master/_trim.asm.annot.uge-bash) to trim illumina reads.

## Requirements
* Nextflow
* Docker or Singularity

## Install
```
git clone https://github.com/gregorysprenger/wf-paired-illumina-read-clean.git
```

## For Aspen Cluster - Set up Singularity PATH
```
# Add to $HOME/.bashrc
SINGULARITY_BASE=/scicomp/scratch/$USER
export SINGULARITY_TMPDIR=$SINGULARITY_BASE/singularity.tmp
export SINGULARITY_CACHEDIR=$SINGULARITY_BASE/singularity.cache
export NXF_SINGULARITY_CACHEDIR=$SINGULARITY_BASE/singularity.cache
mkdir -pv $SINGULARITY_TMPDIR $SINGULARITY_CACHEDIR
```
Reload .bashrc
```
source ~/.bashrc
```

Load nextflow
```
module load nextflow
```

# Run Workflow
Example data are included in assets/test_data directory.

```
nextflow run \
-profile singularity main.nf \
--inpath assets/test_data \
--outpath results
```

Test data was generated by taking top 1 million lines of SRA data SRR16343585. (Note: This requires SRAtoolkit)
```
fasterq-dump SRR16343585
head -1000000 SRR16343585_1.fastq > test_R1.fastq
head -1000000 SRR16343585_2.fastq > test_R2.fastq
gzip test_R*.fastq
```
